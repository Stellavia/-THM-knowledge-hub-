ğŸ”— [Link to the Room](https://tryhackme.com/room/advancedstaticanalysis)

## ğŸ·ï¸ **Topic:** Learn how to identify code constructs and examine the assembly code of malware.

# ğŸ“š Study Notes 

&nbsp;

**== PAGE IN PROGRESS ==**
<!-- Additional sources: Programming reference for the Win32 API â€” https://learn.microsoft.com/en-us/windows/win32/api/ -->

&nbsp;

## Malware Analysis: Overview

---
><details><summary>â“Does advanced static analysis require executing the malware in a controlled environment?</summary>nay</details>
---

## Connecting to the VM

---
><details><summary>â“How many files are present in the Code_Constructs folder on the Desktop?</summary>5</details>
---

## Ghidra: A Quick Overview

---
><details><summary>â“How many function calls are present in the Exports section?</summary>1</details>
---
><details><summary>â“What is the only API call found in the User32.dll under the Imports section?</summary>MessageBoxA</details>
---
><details><summary>â“How many times can the "Hello World" string be found with the Search for Strings utility?</summary>1</details>
---
><details><summary>â“What is the virtual address of the CALL function that displays "Hello World" in a messagebox?</summary>004073d7</details>
---

## Identifying C Code Constructs in Assembly

---
><details><summary>â“What value gets printed by the while loop in the while-loop.exe program?</summary>_ITs_Fun_to_Learn_at_THM_</details>
---
><details><summary>â“How many times, the while loop will run until the condition is met?</summary>4</details>
---
><details><summary>â“Examine the while-loop.exe in Ghidra. What is the virtual address of the instruction, that CALLS to print out the sentence "That's the end of while loop.."?</summary>00401543</details>
---
><details><summary>â“In the if-else.exe program, examine the strings and compelte the sentence "This program demostrates......"</summary>This program demonstrates if-else statement</details>
---
><details><summary>â“What is the virtual address of the CALL to the main function in the if-else.exe program?</summary>00401509</details>
---

## An Overview of Windows API Calls

---
><details><summary>â“When a process is created in suspended state, which hexadecimal value is assigned to the dwCreationFlags parameter?</summary>0x00000004</details>
---

## Common APIs used by Malware

<!-- NO QUESTIONS HERE -->

## Process Hollowing: Overview

---
><details><summary>â“Which API is used to to write malicious code to the allocated memory during process hollowing?</summary>WriteProcessMemory()</details>
---

## Analyzing Process Hollowing

---
><details><summary>â“What is the MD5 hash of the benign.exe sample?</summary>e60a461b80467a4b1187ae2081f8ca24</details>
---
><details><summary>â“How many API calls are returned if we search for the term â€˜Createâ€™ in the Symbol Tree section? </summary>2</details>
---
><details><summary>â“What is the first virtual address where the CreateProcessA function is called?</summary>0040108f</details>
---
><details><summary>â“Which process is being created in suspended state by using the CreateProcessA API call?</summary>iexplore.exe</details>
---
><details><summary>â“What is the first virtual address where the CreateFileA function is called?</summary>004010f0</details>
---
><details><summary>â“What is the suspicious process being injected into the victim process? </summary>evil.exe</details>
---
><details><summary>â“Based on the Function Graph, what is the virtual address of the code block that will be executed if the program doesnâ€™t find the suspicious process?</summary>00401101</details>
---
><details><summary>â“Which API call is found in the import functions used to unmap the processâ€™s memory?</summary>NtUnmapViewOfSection</details>
---
><details><summary>â“How many calls to the WriteProcessMemory function are found in the code? (.text section)</summary>2</details>
---
><details><summary>â“What is the full path of the suspicious process shown in the strings?</summary>C:\\Users\\THM-Attacker\\Desktop\\Injectors\\evil.exe</details>
---

